<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <meta name="description" contents="It is fun, it is fast and is easy. Google and get the results as 3D pegmen">

    <title>google search webspace (v2.1)</title>

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/bootbox-dialoges.css">

    <script>
        var debugMode = true;
        if (navigator.serviceWorker) {
        //  debugMode && console.log(navigator.serviceWorker.controller);
        }
    </script>

<!--script src="/google-search/sw.js"></script -->
    <script src="/js/loadjs.min.js"></script>
    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery-ui.js"></script>
    <script src="/js/bootbox.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>

    <script src="https://cse.google.com/cse.js?cx=013151438370468652337:0mozxitt4ka"></script>

</head>

<body>

<style>

    .gcse-searchresults-only {

    }

    .gsc-search-box,
    .gsc-search-box-tools {
        display: unset !important;
    }

    .gsc-control-wrapper-cse {
        visibility: visible !important;
    }

    .gsc-adBlock, 
    .gcsc-more-maybe-branding-root,
    .gsc-webResult.gsc-result {
        display: block !important;
    }

    .gsc-resultsbox-visible {
        display: block !important;
    }

</style>

<section class="mbr-section" id="body-section">

    <div id="viewer-container" style="position:fixed;top:0;left:0;right:0;bottom:0;margin:0;">
        <iframe id="viewer" src="/google-search/crowd" style="width:100%;height:100%;overflow:hidden;border:none;"></iframe>
    </div>

    <div style="position:absolute;width:100%;margin:0px;">
        <div class="gcse-searchresults-only"></div>
    </div>

</section>


<script>
(function(){

    const viewer = document.getElementById("viewer");
    const contentWindow = viewer.contentWindow;
//  const cx = "013151438370468652337:0mozxitt4ka";
//  const src = "https://cse.google.com/cse.js?cx=013151438370468652337:0mozxitt4ka";
    const resultSelector = ".gs-result";
    const webResultSelector = ".gs-webResult";
    const expansionAreaSelector =".gsc-expansionArea";
    const resultsBoxVisibleSelector = ".gsc-resultsbox-visible";

    var scene, pegmen;

    $(viewer.contentWindow).on("load", function(){
        scene = viewer.contentWindow.scene;
        pegmen = contentWindow.pegmen;
    });

//  "https:https://developers.google.com/custom-search/docs/element"

    window.__gcse = {
    //  parsetags: "explicit", // Defaults to 'onload'
    //  initializationCallback: init,
        searchCallbacks: {
        /*
            image: {
                starting: myImageSearchStartingCallback,
                ready: myImageResultsReadyCallback,
                rendered: myImageResultsRenderedCallback,
            },
        */
            web: {
                starting: start,
                ready: ready,
                rendered: rendered,
            },
        }
    };

    function init(){
        debugMode && console.log( "initialization." );
    }

    function start(){
        debugMode && console.log( "starting search." );
        scene.remove.apply(scene, pegmen);  //  important!
    }

    function ready(){
        debugMode && console.log( "results ready." );
    }

    function rendered(){
        debugMode && console.log( "results rendered." );
        $(".gsc-resultsbox-visible")
        .find(".gsc-expansionArea")
        .find(".gs-webResult.gs-result")
        .toArray().forEach(function(result){
            debugMode && console.log(result);
            contentWindow.createResultPegman( result );
        });
    }

});

</script>


<script>
/*
document.body.onload = function(){

    var n = 0;
    debugMode && console.log( $("button.gsc-search-button.gsc-search-button-v2").get(0) );
    
    const viewer = document.getElementById("viewer");
    const searchButton = $("button.gsc-search-button.gsc-search-button-v2").get(0);

    $(searchButton).on("click", function(){
        //  debugMode && console.log( $(".gsc-resultsbox-visible").find(".gsc-expansionArea").get(0) );
        $(".gsc-resultsbox-visible")
            .find(".gsc-expansionArea")
            .find(".gs-webResult.gs-result")
            .toArray().forEach(function(result){
            debugMode && console.log(result);
        });
    });

    if (navigator.serviceWorker) {
        navigator.serviceWorker.addEventListener("message", function(e){
        //  console.log("Client Received Message:", e.data);

            if ( e.data === "refresh" ){

                var scene = viewer.contentWindow.scene;
                var contentWindow = viewer.contentWindow;
                var pegmen = contentWindow.pegmen;

                if (n == 0) scene.remove.apply(scene, pegmen);  //  important!

                n++;

                var results;
                setTimeout(function(){
                    results = $(".gsc-resultsbox-visible")
                    .find(".gsc-expansionArea")
                    .find(".gs-webResult.gs-result")
                    .toArray();
                    results.forEach(function(result){
                    //  debugMode && console.log(result);
                        contentWindow.createResultPegman( result );
                    });
                }, 0);

            }

        });
    }
}
*/
</script>

</body>
</html>





